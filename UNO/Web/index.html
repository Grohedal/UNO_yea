<!doctype html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css?family=Bellefair" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="Cards.css" rel="stylesheet"/>

    <script>
        $(window).on('load', function () {
        });

        var connection = new WebSocket('ws://localhost:666');

        // When the connection is open, send some data to the server
        connection.onopen = function () {
            connection.send('Ping'); // Send the message 'Ping' to the server
        };

        // Log errors
        connection.onerror = function (error) {
            console.log('WebSocket Error ' + error);
        };

        // Log messages from the server
        connection.onmessage = function (e) {
            var res = JSON.parse(e.data);
            UpdateHand(res.hand);
        };

        function UpdateHand(hand) {
            var specialCards = ['miss', 'switch', 'take-two'];
            var nr = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
            var color = ['yellow', 'red', 'blue', 'green', ' '];

            var handStr = "";

            $(hand).each(function (i, j) {
                
                if (j.Typ != undefined) {
                    handStr += '<div id="card-' + i + '" class="card ' + specialCards[j.Typ] + ' ' + color[j.Farbe] + ' ' + '">' +
                        '    <div class="small"></div>' +
                        '</div>';
                } else {
                    handStr += '<div id="card-' + i + '"  class="card ' + nr[j.Zahl] + ' ' + color[j.Farbe] + ' ' + '">' +
                        '    <div class="small"></div>' +
                        '</div>';
                }

            });
            $('body').html(handStr);
            console.log(hand);
            $(document).ready(function () {
                $('.card').on('click', function (event) {
                    var id = event.target.id;
                    connection.send(id);
                })
            });
        }

    </script>
</head>
<body>
    <div id="hand">

    </div>
</body>
</html>